#!/usr/bin/env bash
set -e

# Database connection details
CONTAINER_NAME="vote-mysql"
MYSQL_USER="vote"
MYSQL_PASS="vote"
MYSQL_DB="vote"

if [ -z "$1" ]; then
    echo "Usage: $0 <sql-query>"
    echo ""
    echo "Examples:"
    echo "  $0 'SELECT * FROM user'"
    echo "  $0 'SELECT * FROM election WHERE owner = \"alice\"'"
    echo "  $0 'SHOW TABLES'"
    echo "  $0 'DESCRIBE user'"
    echo ""
    echo "Tip: Use quotes around the query to handle spaces and special characters"
    exit 1
fi

QUERY="$1"

echo "=========================================="
echo "MySQL Raw Query"
echo "=========================================="
echo ""
echo "Query: $QUERY"
echo ""
echo "Result:"
echo ""

docker exec "$CONTAINER_NAME" mysql -u"$MYSQL_USER" -p"$MYSQL_PASS" "$MYSQL_DB" -e "$QUERY" 2>/dev/null
