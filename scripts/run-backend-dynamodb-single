#!/usr/bin/env bash
set -e

echo "=========================================="
echo "Running Backend with DynamoDB Single-Table"
echo "=========================================="
echo ""

# Ensure DynamoDB Local is running
if ! docker ps --format '{{.Names}}' | grep -q '^vote-dynamodb-local$'; then
    echo "Error: DynamoDB Local is not running"
    echo "Please run: ./scripts/db-setup-dynamodb-single"
    exit 1
fi

echo "Starting backend on port 8080 with single-table DynamoDB..."
echo ""

cd "$(dirname "$0")/.."
./gradlew :backend:run --args="8080 dynamodb-single" --console=plain
