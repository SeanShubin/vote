#!/usr/bin/env bash
set -e

echo "=== DynamoDB Tables Overview (Single-Table Design) ==="
echo ""

ENDPOINT="http://localhost:8000"
REGION="us-east-1"
export AWS_ACCESS_KEY_ID=dummy
export AWS_SECRET_ACCESS_KEY=dummy

# Count main table total
main_count=$(aws dynamodb scan \
    --table-name vote_data \
    --select COUNT \
    --endpoint-url "$ENDPOINT" \
    --region "$REGION" \
    2>/dev/null | jq -r '.Count // 0')

echo "vote_data (main table):   $main_count records"

# Count event log
event_count=$(aws dynamodb scan \
    --table-name vote_event_log \
    --select COUNT \
    --endpoint-url "$ENDPOINT" \
    --region "$REGION" \
    2>/dev/null | jq -r '.Count // 0')

echo "vote_event_log:           $event_count events"

echo ""
echo "Use ./scripts/inspect-dynamodb-all to see complete data breakdown."
echo ""
echo "Or use specific inspect scripts:"
echo "  ./scripts/inspect-dynamodb-users"
echo "  ./scripts/inspect-dynamodb-elections"
echo "  ./scripts/inspect-dynamodb-candidates"
echo "  ./scripts/inspect-dynamodb-voters"
echo "  ./scripts/inspect-dynamodb-ballots"
echo "  ./scripts/inspect-dynamodb-event-log"
echo "  ./scripts/inspect-dynamodb-sync-state"
