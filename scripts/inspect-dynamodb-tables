#!/usr/bin/env bash
set -e

echo "=== DynamoDB Tables Overview ==="
echo ""

ENDPOINT="http://localhost:8000"
REGION="us-east-1"
export AWS_ACCESS_KEY_ID=dummy
export AWS_SECRET_ACCESS_KEY=dummy

tables=(
    "vote_users"
    "vote_elections"
    "vote_candidates"
    "vote_eligible_voters"
    "vote_ballots"
    "vote_event_log"
    "vote_sync_state"
)

for table in "${tables[@]}"; do
    count=$(aws dynamodb scan \
        --table-name "$table" \
        --select COUNT \
        --endpoint-url "$ENDPOINT" \
        --region "$REGION" \
        2>/dev/null | jq -r '.Count // 0')

    printf "%-25s %3d records\n" "$table:" "$count"
done

echo ""
echo "Use specific inspect scripts to see details:"
echo "  ./scripts/inspect-dynamodb-users"
echo "  ./scripts/inspect-dynamodb-elections"
echo "  ./scripts/inspect-dynamodb-candidates"
echo "  ./scripts/inspect-dynamodb-voters"
echo "  ./scripts/inspect-dynamodb-ballots"
echo "  ./scripts/inspect-dynamodb-event-log"
