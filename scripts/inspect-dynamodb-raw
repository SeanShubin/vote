#!/usr/bin/env bash
set -e

ENDPOINT="http://localhost:8000"
export AWS_ACCESS_KEY_ID=dummy
export AWS_SECRET_ACCESS_KEY=dummy
REGION="us-east-1"

if [ -z "$1" ]; then
    echo "Usage: $0 <table-name>"
    echo ""
    echo "Available tables (single-table design):"
    echo "  vote_data         - Main single table (all entities)"
    echo "  vote_event_log    - Event sourcing log"
    echo ""
    echo "Example:"
    echo "  $0 vote_data"
    echo ""
    echo "Tip: Use inspect-dynamodb-raw-all to see all data with PK/SK structure"
    exit 1
fi

TABLE_NAME="$1"

echo "=== Raw DynamoDB Scan of $TABLE_NAME ==="
echo ""
echo "This shows the ACTUAL storage structure (PK/SK, raw attributes)."
echo "Compare with inspect-dynamodb-* scripts that show relational projections."
echo ""

aws dynamodb scan \
    --table-name "$TABLE_NAME" \
    --endpoint-url "$ENDPOINT" \
    --region "$REGION" \
    2>/dev/null | jq '.'
